<Window x:Class="CoursesDekstopApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CoursesDekstopApp"
        xmlns:converters="clr-namespace:CoursesDekstopApp.Converters" 
        mc:Ignorable="d"
        Title="Система Курсів" Height="700" Width="900" MinHeight="600" MinWidth="800">
    
    <Window.Resources>
        <converters:StringNullOrEmptyToVisibilityConverter x:Key="StringNullOrEmptyToVisibilityConverter"/>
    </Window.Resources>
    
    <TabControl>
        
        <TabItem Header="Студенти">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock Text="Список Студентів" Grid.Row="0" FontSize="24" FontWeight="Bold" Margin="0,0,0,10"/>
                <DataGrid Grid.Row="1" ItemsSource="{Binding Students}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="14">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding StudentId}" Width="Auto"/>
                        <DataGridTextColumn Header="Ім'я" Binding="{Binding FirstName}" Width="*"/>
                        <DataGridTextColumn Header="Прізвище" Binding="{Binding LastName}" Width="*"/>
                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="2*"/>
                        <DataGridTextColumn Header="Телефон" Binding="{Binding Phone}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </TabItem>

        <TabItem Header="Запити">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Orientation="Vertical" Margin="10">
                
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="10" CornerRadius="5">
                        <StackPanel Orientation="Vertical">
                            <TextBlock Text="Запит 1: Пошук груп" FontSize="20" FontWeight="Bold"/>
                            <Grid Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Мова:" VerticalAlignment="Center" Margin="5"/>
                                <ComboBox Grid.Column="1" ItemsSource="{Binding Languages}" DisplayMemberPath="Name" SelectedItem="{Binding SelectedLanguage}" Margin="5"/>
                                <TextBlock Grid.Column="2" Text="Викладач:" VerticalAlignment="Center" Margin="5"/>
                                <ComboBox Grid.Column="3" ItemsSource="{Binding Teachers}" DisplayMemberPath="FullName" SelectedItem="{Binding SelectedTeacher}" Margin="5"/>
                                <Button Grid.Column="4" Content="Пошук" Command="{Binding SearchGroupsAsyncCommand}" Padding="20,5" Margin="10,5"/>
                            </Grid>
                            <DataGrid ItemsSource="{Binding FilteredGroups}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="14" MaxHeight="200">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Назва Групи" Binding="{Binding GroupName}" Width="2*"/>
                                    <DataGridTextColumn Header="Мова" Binding="{Binding Level.Language.Name}" Width="*"/>
                                    <DataGridTextColumn Header="Рівень" Binding="{Binding Level.Name}" Width="*"/>
                                    <DataGridTextColumn Header="Викладач" Binding="{Binding Teacher.FullName}" Width="2*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>

                    <Border BorderBrush="Gray" BorderThickness="1" Padding="10" CornerRadius="5" Margin="0,15,0,0">
                        <StackPanel Orientation="Vertical">
                            <TextBlock Text="Запит 2: Розрахунок вартості" FontSize="20" FontWeight="Bold"/>
                            <WrapPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="Вартість ВСІХ мов" Command="{Binding CalcCostAllLanguagesAsyncCommand}" Margin="5"/>
                                <TextBlock Text="Для обраної мови:" VerticalAlignment="Center" Margin="15,5,5,5"/>
                                <Button Content="Повна вартість" Command="{Binding CalcCostSelectedLanguageAsyncCommand}" Margin="5"/>
                                <Button Content="Вартість за рівнями" Command="{Binding CalcCostByLevelAsyncCommand}" Margin="5"/>
                                <Button Content="Вартість за місяць" Command="{Binding CalcCostPerMonthAsyncCommand}" Margin="5"/>
                            </WrapPanel>
                            <TextBlock Text="{Binding CostCalculationResult}" FontSize="16" FontWeight="Bold" Foreground="DarkGreen" Margin="5,10,5,5"
                                       Visibility="{Binding CostCalculationResult, Converter={StaticResource StringNullOrEmptyToVisibilityConverter}}"/>
                            <DataGrid ItemsSource="{Binding CostBreakdown}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="14" MaxHeight="200" Margin="0,5,0,0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Назва" Binding="{Binding Name}" Width="2*"/>
                                    <DataGridTextColumn Header="Вартість" Binding="{Binding Cost, StringFormat=C}" Width="*"/>
                                    <DataGridTextColumn Header="Деталі" Binding="{Binding Details}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>
                    
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="10" CornerRadius="5" Margin="0,15,0,0">
                        <StackPanel Orientation="Vertical">
                            <TextBlock Text="Запит 3: Слухачі, які не склали іспит" FontSize="20" FontWeight="Bold"/>
                            <Button Content="Знайти" Command="{Binding GetFailedExamsAsyncCommand}" Margin="5,10,0,0" HorizontalAlignment="Left" Padding="20, 5"/>
                            <TextBlock FontSize="16" Margin="5,10,5,5">
                                <Run Text="Загальна кількість нездач:"/>
                                <Run Text="{Binding FailedExamsCount}" FontWeight="Bold"/>
                            </TextBlock>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="5">
                                    <TextBlock Text="Список слухачів:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <DataGrid ItemsSource="{Binding FailedExamResults}" AutoGenerateColumns="False" IsReadOnly="True" FontSize="14" MaxHeight="200">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Слухач" Binding="{Binding Student.FullName}" Width="*"/>
                                            <DataGridTextColumn Header="Рівень" Binding="{Binding Exam.Level.Name}" Width="*"/>
                                            <DataGridTextColumn Header="Мова" Binding="{Binding Exam.Level.Language.Name}" Width="*"/>
                                            <DataGridTextColumn Header="Оцінка" Binding="{Binding Grade}" Width="Auto"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="5">
                                    <TextBlock Text="Рівні, на яких були нездачі:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <ListBox ItemsSource="{Binding LevelsWithFailures}" DisplayMemberPath="Name" MaxHeight="200"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="10" CornerRadius="5" Margin="0,15,0,0">
                        <StackPanel Orientation="Vertical">
                            <TextBlock Text="Запит 4: Викладачі за кількістю мов" FontSize="20" FontWeight="Bold"/>
                            
                            <Button Content="Знайти викладачів" 
                                    Command="{Binding GetTeachersByLanguageCountAsyncCommand}" 
                                    Margin="5,10,0,0" 
                                    HorizontalAlignment="Left" 
                                    Padding="20, 5"/>

                            <Grid Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Margin="5">
                                    <TextBlock Text="Одна мова:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <ListBox ItemsSource="{Binding TeachersWithOneLanguage}" 
                                             DisplayMemberPath="FullName" 
                                             MaxHeight="200"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Margin="5">
                                    <TextBlock Text="Дві мови:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <ListBox ItemsSource="{Binding TeachersWithTwoLanguages}" 
                                             DisplayMemberPath="FullName" 
                                             MaxHeight="200"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" Margin="5">
                                    <TextBlock Text="Три мови:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <ListBox ItemsSource="{Binding TeachersWithThreeLanguages}" 
                                             DisplayMemberPath="FullName" 
                                             MaxHeight="200"/>
                                </StackPanel>
                                
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                </StackPanel>
            </ScrollViewer>
        </TabItem>
        
    </TabControl>
</Window>